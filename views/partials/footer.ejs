<%
  const tFn = (typeof t === 'function')
    ? t
    : (typeof locals !== 'undefined' && typeof locals.t === 'function'
      ? locals.t
      : (key) => key);
  const currentLangValue = typeof currentLang !== 'undefined'
    ? currentLang
    : (typeof locals !== 'undefined' && typeof locals.currentLang !== 'undefined'
      ? locals.currentLang
      : 'ro');
  const currentLangLabelValue = typeof currentLangLabel !== 'undefined'
    ? currentLangLabel
    : (typeof locals !== 'undefined' && typeof locals.currentLangLabel !== 'undefined'
      ? locals.currentLangLabel
      : currentLangValue);
  const switchLangValue = typeof switchLang !== 'undefined'
    ? switchLang
    : (typeof locals !== 'undefined' && typeof locals.switchLang !== 'undefined'
      ? locals.switchLang
      : (currentLangValue === 'ro' ? 'en' : 'ro'));
  const switchLangLabelValue = typeof switchLangLabel !== 'undefined'
    ? switchLangLabel
    : (typeof locals !== 'undefined' && typeof locals.switchLangLabel !== 'undefined'
      ? locals.switchLangLabel
      : currentLangLabelValue);
  const brandName = tFn('nav.brand');
  const footerTagline = tFn('footer.brand.tagline');
  const footerRights = tFn('footer.bottom.rights');
  const footerYear = new Date().getFullYear();
  const copyrightHtml = tFn('footer.bottom.copyright')
    .replace('{year}', footerYear)
    .replace('{brand}', brandName)
    .replace('{rights}', footerRights);
  const cookiesLinkHtml = `<a href="/legal/cookies">${tFn('footer.links.cookies')}</a>`;
  const cookieDescriptionHtml = tFn('footer.cookie.description').replace('{cookiesLink}', cookiesLinkHtml);
  const supportPhoneRaw = tFn('footer.contact.phone');
  const supportPhoneDigits = (supportPhoneRaw || '').replace(/\D/g, '');
  const whatsappNumber = supportPhoneDigits && supportPhoneDigits.length >= 8 ? supportPhoneDigits : '40721171995';
  const supportEmail = tFn('footer.contact.email');
  const supportPhoneHref = supportPhoneDigits ? `+${supportPhoneDigits}` : '';
  const isUserLoggedIn = typeof user !== 'undefined' && user;
  const faneNewChatLabel = currentLangValue === 'en' ? 'New chat' : 'Chat nou';
  const faneNewChatConfirm = currentLangValue === 'en'
    ? 'Start a new conversation with FANE? This will clear the previous messages.'
    : 'Vrei sÄƒ Ã®ncepi un chat nou cu FANE? Se È™terge istoricul conversaÈ›iei.';
  const faneCloseChatLabel = currentLangValue === 'en' ? 'Close chat' : 'ÃŽnchide chatul';
%>
<footer class="site-footer">
  <div class="site-footer__inner">
    <div class="site-footer__brand">
      <a href="/" class="site-footer__logo">
        <span class="site-footer__logo-icon" aria-hidden="true">
          <img
            src="/images/IMEIGUARD_LOGO.svg"
            alt=""
            class="site-footer__logo-img"
            loading="lazy">
        </span>
        <span class="site-footer__logo-text"><%= brandName %></span>
      </a>
      <p class="site-footer__tagline"><%= footerTagline %></p>
    </div>
    <div class="site-footer__grid">
      <div class="site-footer__column">
        <h4 class="site-footer__title"><%= tFn('footer.columns.resources.title') %></h4>
        <ul class="site-footer__links">
          <li><a href="/verify/imei"><%= tFn('footer.links.verify') %></a></li>
          <li><a href="/dashboard/credits/topup"><%= tFn('footer.links.topup') %></a></li>
          <li><a href="/faq"><%= tFn('footer.links.faq') %></a></li>
        </ul>
      </div>
      <div class="site-footer__column">
        <h4 class="site-footer__title"><%= tFn('footer.columns.legal.title') %></h4>
        <ul class="site-footer__links">
          <li><a href="/legal/terms"><%= tFn('footer.links.terms') %></a></li>
          <li><a href="/legal/privacy"><%= tFn('footer.links.privacy') %></a></li>
          <li><a href="/legal/gdpr"><%= tFn('footer.links.gdpr') %></a></li>
          <li><a href="/legal/cookies"><%= tFn('footer.links.cookies') %></a></li>
        </ul>
      </div>
      <div class="site-footer__column">
        <h4 class="site-footer__title"><%= tFn('footer.columns.contact.title') %></h4>
        <ul class="site-footer__links">
          <li><a href="mailto:<%= supportEmail %>"><%= supportEmail %></a></li>
          <li><a href="tel:<%= supportPhoneHref %>"><%= supportPhoneRaw %></a></li>
          <li>
            <a href="https://wa.me/<%= whatsappNumber %>" target="_blank" rel="noopener">
              WhatsApp
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>
  <div class="site-footer__bottom">
    <span class="site-footer__copyright"><%- copyrightHtml %></span>
    <div class="site-footer__badges">
      <span class="site-footer__badge"><%= tFn('footer.badges.stripe') %></span>
      <span class="site-footer__badge"><%= tFn('footer.badges.gdpr') %></span>
    </div>
  </div>
</footer>

</main>

<div class="cookie-banner" id="cookie-banner" role="dialog" aria-live="polite" aria-label="<%= tFn('footer.cookie.aria') %>">
  <div class="cookie-banner-content">
    <div class="cookie-text">
      <h3><%= tFn('footer.cookie.title') %></h3>
      <p>
        <%- cookieDescriptionHtml %>
      </p>
    </div>
    <div class="cookie-actions">
      <button type="button" class="btn btn-secondary" id="cookie-settings"><%= tFn('footer.cookie.cta.settings') %></button>
      <button type="button" class="btn btn-primary" id="cookie-accept"><%= tFn('footer.cookie.cta.accept') %></button>
    </div>
  </div>
</div>

<div class="fane-bot" id="fane-bot" aria-live="polite" data-auth="<%= isUserLoggedIn ? 'true' : 'false' %>">
  <button type="button" class="fane-bot-toggle" id="fane-bot-toggle" aria-expanded="false" aria-controls="fane-bot-window">
        <span class="fane-bot-avatar" aria-hidden="true">ðŸ§ </span>
    <span class="fane-bot-toggle-label">FANE BOT</span>
  </button>
  <div class="fane-bot-window" id="fane-bot-window" hidden>
    <header class="fane-bot-header">
      <div class="fane-bot-header-info">
        <span class="fane-bot-name">FANE BOT</span>
        <span class="fane-bot-role">Expert GSM &amp; ReparaÈ›ii</span>
      </div>
      <div class="fane-bot-header-actions">
        <button
          type="button"
          class="fane-bot-reset"
          id="fane-bot-reset"
          data-confirm="<%= faneNewChatConfirm %>"
          aria-label="<%= faneNewChatLabel %>">
          <span class="fane-bot-reset-icon" aria-hidden="true">âŸ³</span>
          <span class="fane-bot-reset-label"><%= faneNewChatLabel %></span>
        </button>
        <button
          type="button"
          class="fane-bot-close"
          id="fane-bot-close"
          aria-label="<%= faneCloseChatLabel %>">
          âœ•
        </button>
      </div>
    </header>
    <div class="fane-bot-messages" id="fane-bot-messages" role="log"></div>
    <div class="fane-bot-status" id="fane-bot-status" hidden></div>
    <form class="fane-bot-form" id="fane-bot-form" novalidate>
      <label class="sr-only" for="fane-bot-input">Mesaj cÄƒtre FANE</label>
      <button type="button" class="fane-bot-suggest-toggle" id="fane-bot-suggest-toggle" aria-expanded="false" aria-controls="fane-bot-suggestions">
        <span class="sr-only">Sugestii Ã®ntrebÄƒri</span>
        <span class="fane-bot-suggest-icon">?</span>
      </button>
      <textarea id="fane-bot-input" class="fane-bot-input" rows="2" placeholder="VorbeÈ™te cu FANE !" required></textarea>
      <button type="submit" class="fane-bot-send" id="fane-bot-send">Trimite</button>
    </form>
    <div class="fane-bot-suggestions" id="fane-bot-suggestions" aria-label="Sugestii rapide" hidden></div>
  </div>
</div>

<script src="/js/main.js"></script>
<script src="/js/fane-bot.js" defer></script>
</body>
</html>
