<%- include('../partials/header', { title: t('auth.register.pageTitle'), user: user }) %>

<div class="auth-container">
  <div class="auth-card">
    <h1 class="auth-title"><%= t('auth.register.heading') %></h1>
    <p class="auth-subtitle"><%= t('auth.register.subtitle') %></p>
    
    <%- include('../partials/flash', { errors: errors }) %>
    
  <form action="/auth/register" method="POST" class="auth-form" id="register-form">
    <input type="hidden" name="_csrf" value="<%= typeof csrfToken !== 'undefined' ? csrfToken : '' %>">
      <div class="form-group">
        <label for="email"><%= t('auth.register.form.email.label') %></label>
        <input 
          type="email" 
          id="email" 
          name="email" 
          required 
          autocomplete="email"
          placeholder="<%= t('auth.register.form.email.placeholder') %>"
          value="<%= typeof formData !== 'undefined' && formData.email ? formData.email : '' %>"
        >
      </div>
      
      <div class="form-group">
        <label for="password"><%= t('auth.register.form.password.label') %></label>
        <input 
          type="password" 
          id="password" 
          name="password" 
          required 
          autocomplete="new-password"
          placeholder="<%= t('auth.register.form.password.placeholder') %>"
          minlength="6"
        >
      </div>

      <div class="form-group">
        <label for="passwordConfirm"><%= t('auth.register.form.passwordConfirm.label') %></label>
        <input
          type="password"
          id="passwordConfirm"
          name="passwordConfirm"
          required
          autocomplete="new-password"
          placeholder="<%= t('auth.register.form.passwordConfirm.placeholder') %>"
          minlength="6"
        >
      </div>
      
      <button type="submit" class="btn btn-primary btn-block" id="register-submit"><%= t('auth.register.form.submit') %></button>
    </form>

    <div class="form-loading" id="register-loading" hidden>
      <div class="spinner"></div>
      <p><%= t('auth.register.loadingMessage') %></p>
    </div>
    
    <p class="auth-footer">
      <%= t('auth.register.footer.question') %> <a href="/auth/login"><%= t('auth.register.footer.link') %></a>
    </p>
  </div>
</div>

<%- include('../partials/footer') %>

<script>
  (function() {
    const form = document.getElementById('register-form');
    const submitBtn = document.getElementById('register-submit');
    const loading = document.getElementById('register-loading');

    if (!form || !submitBtn) return;

    form.addEventListener('submit', function handleSubmit() {
      submitBtn.disabled = true;
      submitBtn.classList.add('is-loading');
      if (loading) {
        loading.hidden = false;
      }
    });
  })();
</script>
